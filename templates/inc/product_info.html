{% load static %}
<style>
    
   
    .prices-hp {
        font-size: 15px;
        font-weight: 500;
        color: darkgray;
    }

    .mrp-prices {
        font-size: 13px;
        font-weight: 500;
        color: darkgray;
        text-decoration: none;
    }

    .act-prices {
        color: green;
        font-weight: 400;
    }

    .button-color {
        background-color: rgb(245, 131, 89);
        font-weight: 500;
        width: 200px;
        border-radius: 40px;

    }

    .button-color:hover {
        background-color: rgb(252, 95, 39);
    }

    .buy-content {
        width: 200px;
        border-radius: 40px;
    }

    .brand_name {
        color: rgb(3, 116, 186);
    }
    #back{
        cursor: pointer;
    }
    .product_name{
        height: 10px;
        width: 30px;
        overflow: hidden;
        /* color: aqua; */
    }
    .images {
    position: sticky;
    top: 0;
    height: 100vh; /* Ensure the height is full viewport */
    overflow: hidden; /* Prevent scrolling inside the image column */
    }
    .featureItem{
    height: 60px;
    width: 60px;
    }

    .feature {
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: space-between;
    text-align: center;
    margin: 0px 40px;
    }
    .features img {
    max-width: 100px; /* Ensure icons are the correct size */
    margin-bottom: 5px;
    }

   .features p {
    font-size: 14px; /* Adjust text size */
    margin: 0;
    }
    .rate-btn{
        box-shadow: rgba(0, 0, 0, 0.24) 0px 3px 8px;
        font-weight: bold;
        
    }
    
</style>

    
    <div class="row d-flex justify-content-start   product-boxing" style="margin-top:80px; " >
        
        <div class="col">
            
            <div class="card" style="background-color:rgb(207, 228, 207);">
                
                <div class="row" >
                    <div class="col-md-4 d-flex justify-content-center" >
                        <div class="images p-3 ">

                            <div class="text-center p-4"> <img id="main-image" src="{{products.image_product.url}}"
                                    width="420" height="450" /> </div>
                            <div class="thumbnail text-center"> <img onclick="change_image(this)"
                                    src="{{products.image_product.url}}" width="70"> <img onclick="change_image(this)"
                                    src="{{products.image_product_2.url}}" width="70" alt="{% if products.image_product_2 %}Product Image{% else %}No Image Available{% endif %}"> </div>

                        </div>
                        <hr>
                    </div>
                    
                    <div class="col-md-8 d-flex justify-content-start m-0">
                        <div class="products" >
                            <nav aria-label="breadcrumb">
                                <ol class="breadcrumb">
                                  <li class="breadcrumb-item"><a href="{% url 'home' %}">Home</a></li>
                                  <li class="breadcrumb-item"><a href="{% url 'collections' products.group_name %}">Collections</a></li>
                                  <li class="breadcrumb-item active" aria-current="page">{{products.name_product}}</li>
                                </ol>
                              </nav>
                            <div class="d-flex justify-content-between align-items-center">
                                <div class="d-flex align-items-center" id="back" onclick="goback()"> <i class="fa fa-long-arrow-left"></i> <span
                                        class="ml-1">Back</span> </div> 
                            </div>
                            <div class="mt-4 mb-3"> 
                                <span class="text-uppercase brand_name brand fw-bold " style="font-size: larger;">{{products.brand_name}}</span>
                                <h5 class="text-uppercase ">{{products.name_product}}</h5>
                                    
                                
                                <div class="price d-flex flex-row align-items-center"> 
                                    <span class="mx-2" style=" font-size: 25px; font-weight: 700;">â‚¹{{products.discounted_price}}</span>
                                    <span class="act-prices fw-bold">{{products.discount_percentage |stringformat:"d" }}% off</span>
                                </div>
                                <div class="ml-2"><s class="mrp-prices">M.R.P:</s> <span
                                        class="prices-hp "><s>{{products.mrp_price}}</s></span><br>
                                    <s class="mrp-prices">Inclusive All Tax</s>
                                    <br>
                                    <div>
                                        {% if products.quantity == 0 %}
                                            <span class="text-danger ">Out of Stock</span>
                                        {% else %}
                                            <span class="text-success">In Stock</span>
                                        {% endif %}
                                    </div>
                                
                                </div>
                            </div>
                           <div class="text-uppercase fw-bold text-success" ></div>
                        
                            <div class="sizes mt-5 ">
                                <input type="hidden" value="{{products.id}}" name="" id="pid">
                                
                                <p>
                                    <div class="input-group" style="width: 150px;">
                                        <button class="input-group-text btn btn-success text-light" id="btnMinus"><i class="fa fa-minus"></i></button>
                                            <input type="text" name="qty" class="form-control text-center" id="txtQty" value="1">
                                        <button class="input-group-text btn btn-success text-light" id="btnPlus"><i class="fa fa-plus"></i></button>

                                    </div>
                                </p>
                               
                                <div class="cart mt-4 align-items-center">
                                    <button id="btnCarts" class="btn button-color text-uppercase px-4   w-xs-100" data-bs-toggle="modal" data-bs-target="#exampleModal"><i
                                        class="fas fa-shopping-cart me-2"></i>Add to Cart</button>
                                    <i class="fa fa-heart text-muted"></i> <i class="fa fa-share-alt text-muted"></i>

                                </div>
                                <a href="#"
                                    class="btn btn-success buy-content px-4 mt-2  w-sm-100 text-center text-uppercase "
                                    style="font-weight: 500;"><i class="fas fa-bag-shopping me-2"></i>Buy Now</a>
                                <div class="features mt-4">
                                        <div class="d-flex justify-content-between align-items-center">
                                            <div class="feature">
                                                <img class="featureItem" src="{% static 'images/cashinhand.svg' %}" alt="Cash on Delivery" width="50">
                                                <p>Cash on Delivery</p>
                                            </div>
                                            <div class="feature" >
                                                <img class="featureItem" src="{% static 'images/product-return.png' %}" alt="48 Hours Return" width="50">
                                                <p>48 Hours Return</p>
                                            </div>
                                            <div class="feature">
                                                <img class="featureItem" src="{% static 'images/free-delivery.png' %}" alt="Free Shipping" width="50">
                                                <p>Free Shipping</p>
                                            </div>
                                        </div>
                                </div>
                                <div class="decription mt-2">
                                    <h3 class="text-uppercase mb-3 ">Description</h3>
                                    <ul>
                                    {% for line in products.description.splitlines %}
                                        <li>{{ line }}</li>
                                    {% endfor %}
                                    </ul>
                                </div>
                                <div>
                                    <h3 class="text-uppercase mb-3">FEATURES & BENEFITS</h3>
                                    <ul>
                                        {% for line in products.benefits.splitlines %}
                                            <li>{{ line }}</li>
                                        {% endfor %}
                                </div>
                                {% if products.group_name == 'Sprayer' %}
                                <div>
                                    <h3 class="text-uppercase mb-3">TECHNICAL SPECIFICATION</h3>
                                    <ul>
                                        {% for line in products.technical_specifications.splitlines %}
                                            <li>{{ line }}</li>
                                        {% endfor %}
                                    </ul>
                                    
                                </div>
                                {% else %}
                                <div>
                                    <h3 class="text-uppercase mb-3>">Recommendation</h3>
                                    <ul>
                                        {% for line in products.recommendations.splitlines %}
                                            <li>{{ line }}</li>
                                        {% endfor %}
                                    </ul>
                                </div>
                                {% endif %}
                                
                                <h3 class="text-uppercase mb-3">Product Demonstration</h3>
                                    <div>
                                        <iframe width="560" height="315" src="{{ products.demonstration_video }}" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
                                    </div>
                                
                                <hr>
                                <div class="d-flex justify-content-between align-items-center mt-4">
                                    <h3 class="text-uppercase mb-3">Customer Reviews</h3>
                                    <button class="btn rate-btn">Rate Product</button>
                                </div>
                                
                            </div>
                        </div>

                    </div>
                </div>

            </div>
        </div>
    </div>
    

  
  <!-- Modal -->
  <div class="modal fade" id="exampleModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
          <h1 class="modal-title fs-5" id="exampleModalLabel">Notification</h1>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body text-uppercase fw-bold" id="message">
          
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-success" data-bs-dismiss="modal">Ok</button>
        </div>
      </div>
    </div>
  </div>
<script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.9.2/dist/umd/popper.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.0/dist/js/bootstrap.min.js"></script>
<script>
        function goback(){
            window.history.back();
        }

        document.addEventListener('DOMContentLoaded', function() {
            const btnPlus = document.getElementById('btnPlus');
            const btnMinus = document.getElementById('btnMinus');
            const txtQty = document.getElementById('txtQty');
            const pid = document.getElementById('pid');
            const btnCart = document.getElementById('btnCarts');

            
            
            btnPlus.addEventListener('click', function() {
                let qty = parseInt(txtQty.value, 10);
                qty = isNaN(qty) ? 0 : qty;
                if (qty < 10) {
                    qty++;
                    txtQty.value = qty;    
                }
                
            

            });

            btnMinus.addEventListener('click', function() {
                let qty = parseInt(txtQty.value, 10);
                qty = isNaN(qty) ? 0 : qty;
                if (qty > 1) {
                    qty--;
                    txtQty.value = qty;
                }
            });

            btnCart.addEventListener('click', function() {
                let qty = parseInt(txtQty.value, 10);
                qty = isNaN(qty) ? 0 : qty;
                if (qty > 0) {
                    let postObj = {
                        'product_qty': qty,
                        'pid': pid.value
                        
                    };
                    console.log(postObj);
                    
                    fetch("/addtocart", {
                        method: 'POST',
                        credentials: 'same-origin',
                        headers: {
                            'Content-Type': 'application/json',
                            'X-requested-With': 'XMLHttpRequest',
                            'X-CSRFToken': '{{ csrf_token }}'
                            
                        },
                        body: JSON.stringify(postObj)
                    })
                    .then(response => {
                        return response.json();
                    })
                    .then(data => {
                        console.log(data);
                        let messageElement = document.getElementById('message');
                    
                    // Remove existing classes
                    messageElement.classList.remove('text-success', 'text-danger');
                    
                    // Add appropriate class and set text
                    if (data.status === 'Product added to cart successfully') {
                        messageElement.classList.add('text-success');
                    } else {
                        messageElement.classList.add('text-danger');
                    }

                    messageElement.innerText = data.status;

                    }); 
                    
                }
                else{
                        alert("Please select quantity");
                    }

        
            });   


        });



      

    </script>